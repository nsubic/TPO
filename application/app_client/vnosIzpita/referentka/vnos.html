<referentkaglava></referentkaglava>

   <div class="container" style="width:100%;height:100%" >
         <h2  style="margin:30px;margin-top:0px" align="center">Vnos novega izpita</h2>
    <form ng-submit="">
      <div class="form-group">
        <label for="filter">Izberi študijsko leto:</label>
        	<select id="filter" name="show-filter" ng-model="letoFilter"  class="form-control" style="width:100%"
    ng-options="leto as leto.studijsko_leto  for leto in vm.leto.leto "></select>
        
        <label for="sel1">Izberi profesorja:</label>
        	<select id="sel1" name="show-filter" ng-model="profesorFilter"  class="form-control" style="width:100%"
    ng-options="profesor as profesor.sifra_profesorjaFK1 + ' ' + profesor.ime + ' ' +  profesor.priimek + ' ' +  profesor.sifra_profesorjaFK2 +  ' ' + profesor.ime_profesorja2 + ' ' + profesor.priimek_profesorja2 + ' ' + profesor.sifra_profesorjaFK3 + ' ' + profesor.ime_profesorja3 + ' ' + profesor.priimek_profesorja3
    for profesor in vm.dataProf.prof | filter: {studijsko_letoFK: letoFilter.studijsko_leto} 
    | filterzaOR: predmetFilter.sifra_profesorjaFK1:predmetFilter.sifra_profesorjaFK2:predmetFilter.sifra_profesorjaFK3:predmetFilter.sifra_predmeta  ">
       </select>        
        <label for="sel2">Izberi predmet:</label>
        <select id="sel2" name="show-filter" ng-model="predmetFilter"  class="form-control" style="width:100%"
    ng-options="p as p.sifra_predmeta + ', ' + p.ime_predmeta for p in vm.dataSub.subjects | filterzaORpro: profesorFilter.sifra_profesorjaFK1:profesorFilter.sifra_profesorjaFK2:profesorFilter.sifra_profesorjaFK3"></select>
        <label for="sel3">Izberi rok:</label>
          <div class="input-group mb-3">
            <div class="input-group-prepend">
            </div>
            <input type="number" min="1" max="10" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default" ng-model="vm.podatki.rok">
          </div>
        <div class="form-group">
          <label for="izberiDatum">Izberi datum:</label>
            <input id="izberiDatum" name="izberiDatum"class="form-control" type="date" placeholder="geslo" ng-model="vm.podatki.datum">
          </label>
        </div>
        <div class="form-group" >
          <label for="izberiCas">Čas izvajanja izpita:</label>
          <div class="input-group mb-3">
            <div class="input-group-prepend">
            </div>
            <input type="text" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default" ng-model="vm.podatki.ura">
          </div>
        </div>
        <label for="sel4">Izberi lokacijo:</label>
         <div class="row" style="z-index:2000">
         <div class="col-lg-12" >
         <div class="button-group">
          <button type="button" id="sel4" style="" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown"  ng-model="vm.podatki.lokacija"><span class="glyphicon glyphicon-cog"></span> <span class="caret"></span></button>
          <ul class="dropdown-menu"   style="z-index:2000">
          <option selected="" disabled="" hidden=""></option>
          <li><a href="#"  data-value="PA" tabIndex="-1"><input type="checkbox"/>&nbsp;PA</a></li>
          <li><a href="#"  data-value="PB" tabIndex="-1"><input type="checkbox"/>&nbsp;PB</a></li>
          <li><a href="#"  data-value="P1" tabIndex="-1"><input type="checkbox"/>&nbsp;P1</a></li>
          <li><a href="#"  data-value="P2" tabIndex="-1"><input type="checkbox"/>&nbsp;P2</a></li>
          <li><a href="#"  data-value="P3" tabIndex="-1"><input type="checkbox"/>&nbsp;P3</a></li>
          <li><a href="#"  data-value="P4" tabIndex="-1"><input type="checkbox"/>&nbsp;P4</a></li>
          <li><a href="#"  data-value="P5" tabIndex="-1"><input type="checkbox"/>&nbsp;P5</a></li>
          <li><a href="#"  data-value="P6" tabIndex="-1"><input type="checkbox"/>&nbsp;P6</a></li>
          <li><a href="#"  data-value="P7" tabIndex="-1"><input type="checkbox"/>&nbsp;P7</a></li>
          <li><a href="#"  data-value="P8" tabIndex="-1"><input type="checkbox"/>&nbsp;P8</a></li>
          <li><a href="#"  data-value="P9" tabIndex="-1"><input type="checkbox"/>&nbsp;P9</a></li>
          <li><a href="#"  data-value="P10" tabIndex="-1"><input type="checkbox"/>&nbsp;P10</a></li>
          <li><a href="#"  data-value="P11" tabIndex="-1"><input type="checkbox"/>&nbsp;P11</a></li>
          <li><a href="#"  data-value="P12" tabIndex="-1"><input type="checkbox"/>&nbsp;P12</a></li>
          <li><a href="#"  data-value="P13" tabIndex="-1"><input type="checkbox"/>&nbsp;P13</a></li>
          <li><a href="#"  data-value="P14" tabIndex="-1"><input type="checkbox"/>&nbsp;P14</a></li>
          <li><a href="#"  data-value="P15" tabIndex="-1"><input type="checkbox"/>&nbsp;P15</a></li>
          <li><a href="#"  data-value="P16" tabIndex="-1"><input type="checkbox"/>&nbsp;P16</a></li>
          <li><a href="#"  data-value="P17" tabIndex="-1"><input type="checkbox"/>&nbsp;P17</a></li>
          <li><a href="#"  data-value="P18" tabIndex="-1"><input type="checkbox"/>&nbsp;P18</a></li>
          <li><a href="#"  data-value="P19" tabIndex="-1"><input type="checkbox"/>&nbsp;P19</a></li>
          <li><a href="#"  data-value="P20" tabIndex="-1"><input type="checkbox"/>&nbsp;P20</a></li>
          <li><a href="#"  data-value="P21" tabIndex="-1"><input type="checkbox"/>&nbsp;P21</a></li>
          <li><a href="#"  data-value="P22" tabIndex="-1"><input type="checkbox"/>&nbsp;P22</a></li>
        </ul>
          </div>
        </div>
          </div>
      </div>
      <div role="alert" ng-show="vm.napakaNaObrazcu" class="alert alert-danger">{{ vm.napakaNaObrazcu }}</div>
      <button id="listAdd" type="submit" class="btn btn-default" ng-click="vm.dodajIzpit(profesorFilter,predmetFilter.sifra_predmeta)">Dodaj izpit</button>
    </form>
  </div>
  
  <div class="my-3 p-3 bg-white rounded box-shadow" style="height:100%;width:100%;overflow:auto;">
    <h2 style="margin:30px" align="center">Seznam vseh izpitov</h2>
    <div role="alert" ng-show="vm.izbris2" class="alert alert-danger row" style="width:100%">{{ vm.izbris2 }}</div>
  <table id="ena" class="table table-striped table-hover table-bordered" >
	  <thead class="thead-dark">
		<tr>
		  <th>Šifra predmeta</th>
		  <th>Ime predmeta</th>
		  <th>Datum</th>
		  <th>Ura</th>
		  <th>Lokacija</th>
		  <th>Profesor</th>
		  <th></th>
		  <th></th>
		  <th></th>
		</tr>
	  </thead>
	  <tbody>
		  <tr ng-repeat="s in vm.dataExam.exams">
  			<td style="vertical-align: middle;" >{{s.Predmet_sifra_predmeta}}</td>
  			<td style="vertical-align: middle;">{{s.ime_predmeta}}</td>
  			<td style="vertical-align: middle;"> {{s.datum | filterDATUMinURA}}</td>
  			<td style="vertical-align: middle;">{{s.ura}} </td>
  			<td style="vertical-align: middle;">{{s.lokacija}} </td>
  			<td style="vertical-align: middle;">{{s.profesor_ime}} </td>
  			<td><button ng-click="vm.shraniSifroIzpit(s.sifra, s.datum, s.ura, s.ime_predmeta)" data-toggle="modal" data-target="#exampleModalLong1" class="delete">Izbriši izpit</button></td>
  			<td><button  ng-click="vm.prijavljeniStudenti(s.sifra, s.datum, s.ura)" data-toggle="modal" data-target="#exampleModalLong"  class="delete">Dodaj ocene/ Odjavi Studenta</button></td>
  			<td><button  ng-click="vm.shraniSifroIzpit(s.sifra, s.datum, s.Predmet_sifra_predmeta, s.ura)" data-toggle="modal" data-target="#exampleModalLong2">Prijavi študenta</button></td>
        
		  </tr>
	  </tbody>
	</table>
  </div>
</div>


<div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Seznam študentov</h5>
        <button type="button" class="close" onclick="javascript:window.location.reload()" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div id="source1" class="modal-body"  style="height:100%;width:100%;overflow:auto;">
        <link rel="stylesheet" media="screen" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <h3>{{ vm.ime }}</h3>
        <div role="alert" ng-show="vm.napakaNaObrazcu1" class="alert alert-danger">{{ vm.napakaNaObrazcu1 }}</div>
        <div role="alert" ng-show="vm.napakaNaObrazcu3" class="alert alert-danger">{{ vm.napakaNaObrazcu3 }}</div>
        <div>Za vrnjeno prijavo vpišite VP v eno izmed polj oz. v oba polja.</div>
         <table class="table1">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Vpisna št.</th>
              <th scope="col">Ime</th>
              <th scope="col">Priimek</th>
              <th scope="col">Št. točk</th>
              <th scope="col">Končna Ocena</th>
            </tr>
          </thead>
</div>
          <tbody>
            <form name="vnosOcen">
            <tr class="form-group table td" ng-repeat="p in vm.prijavljeni.stu">
                <th scope="row">{{$index +1}}</th>
                <ng-form name="vnosOcenPosamezno">
                <td>{{ p.Student_vpisna_st  }}</td>
                <td>{{ p.ime  }}</td>
                <td>{{ p.priimek  }}</td>
                 <!-- tuki morm zj poi tm window.getSIFRO in poi putam glede na te dve  -->
                <td><input type="text" id="tockeNove" ng-model="p.tocke_na_izpitu" style="width:110%;" value="{{ p.tocke_na_izpitu }}"><br></td>
                 <td><input type="text" id="ocenaNova" ng-model="p.ocena" style="width:110%;" value="{{ p.ocena }}"><br></td>
                <td><input type="submit" ng-click="vm.dodajanjeOcen(p)" value="Vnesi"></td>
                <td><input type="submit"  ng-click="vm.dodajanjeOcen1(p)" value="Odjavi"></td>
              </ng-form>
            </tr>
            </form>
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" onclick="javascript:window.location.reload()" class="btn btn-secondary" data-dismiss="modal" >Zapri</button>
        <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#exampleModalLong1" ng-onclick="()">Shrani kot csv ali pdf</button>

      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="exampleModalLong1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Seznam študentov</h5>
        
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div id="source" class="modal-body" style="height:100%;width:100%;overflow:auto;">
        <link rel="stylesheet" media="screen" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <div role="alert" ng-show="vm.napakaNaObrazcu4" class="alert alert-danger">{{ vm.napakaNaObrazcu4 }}</div>
         <table class="table">
          <thead>
            <tr>
              <th  class="TOTR" scope="col">#</th>
              <th class="TOTR"  scope="col">Vpisna št.</th>
              <th scope="TOTR">Ime</th>
              <th scope="TOTR">Priimek</th>
              <th class="TOTR"  scope="col">Št. točk</th>
              <th class="TOTR"  scope="col">Ocena</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="p in vm.prijavljeni.stu">
              <th class="TOTR"  scope="row">{{$index +1}}</th>
              <td class="TOTR" >{{ p.Student_vpisna_st  }}</td>
              <td class="TOTR" >{{ p.ime }}</td>
              <td class="TOTR" >{{ p.priimek }}</td>
              <td class="TOTR" >{{ p.tocke_na_izpitu }}</td>
              <td class="TOTR" >{{ p.ocena }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" >Zapri</button>
        <button type="button" class="btn btn-primary" onclick="demoFromHTML()">Shrani kot pdf</button>
        <button type="button" class="btn btn-primary" onclick="myFunction2()">Shrani kot csv</button>
        <button ng-click="vm.izbrisi()" class="delete btn btn-primary">Izbriši izpit</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="exampleModalLong2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Prijavi študenta</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div id="source1" class="modal-body"  style="height:100%;width:100%;overflow:auto;">
        <link rel="stylesheet" media="screen" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <h3>{{ vm.ime }}</h3>
        <div role="alert" ng-show="vm.napakaNaObrazcu5" class="alert alert-danger">{{ vm.napakaNaObrazcu5 }}</div>
</div>
            <form name="vnosOcen">
            <tr class="form-group">
                <ng-form name="vnosOcenPosamezno">
              Vpisna št.:<br>
              <input type="text" id="vpisna" ng-model="vm.novaPrijavaVpisna"  value="vpisnaStudenta"><br>
              <br>
              <button ng-click="vm.prijavi(vm.novaPrijavaVpisna)" class="delete">Prijavi se</button>

              </ng-form>
            </tr>
            </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" >Zapri</button>
      </div>
    </div>
  </div>
</div>



<script>
$('#exampleModalLong').on('shown.bs.modal', function () {
  $('#myInput').trigger('focus')
})
$('#exampleModalLong1').on('shown.bs.modal', function () {
  $('#exampleModalLong').on('hide', function () {
})
  $('#myInput').trigger('focus')
})
$('#exampleModalLong2').on('shown.bs.modal', function () {
  $('#myInput').trigger('focus')
})
</script>
